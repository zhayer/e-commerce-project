!function(){"use strict";var e,t={4664:function(){var e=window.wp.blocks,t=window.React,r=window.wp.primitives,n=(0,t.createElement)(r.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(r.Path,{d:"m3 5c0-1.10457.89543-2 2-2h13.5c1.1046 0 2 .89543 2 2v13.5c0 1.1046-.8954 2-2 2h-13.5c-1.10457 0-2-.8954-2-2zm2-.5h6v6.5h-6.5v-6c0-.27614.22386-.5.5-.5zm-.5 8v6c0 .2761.22386.5.5.5h6v-6.5zm8 0v6.5h6c.2761 0 .5-.2239.5-.5v-6zm0-8v6.5h6.5v-6c0-.27614-.2239-.5-.5-.5z",fillRule:"evenodd",clipRule:"evenodd"})),a=window.wp.data,o=window.wp.element,c=window.wp.blockEditor,l=window.wp.i18n,s=window.wp.components;const u=[["core/group",{layout:{type:"flex",justifyContent:"space-between"},style:{spacing:{margin:{bottom:"10px"}}}},[["core/group",{layout:{type:"flex",flexWrap:"nowrap"}},[["surecart/product-list-sort",{}],["surecart/product-list-filter",{}]]],["surecart/product-list-search",{style:{layout:{selfStretch:"fixed",flexSize:"250px"}}}]]],["core/group",{layout:{type:"flex",flexWrap:"nowrap"},style:{spacing:{margin:{bottom:"10px"}}}},[["surecart/product-list-filter-tags"]]],["surecart/product-template",{style:{spacing:{blockGap:"30px"}},layout:{type:"grid",columnCount:4}}],["surecart/product-pagination"],["surecart/product-list-no-products",{},[["core/paragraph",{placeholder:(0,l.__)("Add text or blocks that will display when a query returns no products.","surecart"),align:"center",content:(0,l.__)("No products found.","surecart")}]]]];var i=window.wp.compose,p=window.wp.coreData,d=window.wp.htmlEntities;const m=e=>{const t=(0,a.useSelect)((t=>{const{getTaxonomies:r,getPostType:n}=t(p.store);return n(e)?.taxonomies?.length>0?r({type:e,per_page:-1}):[]}),[e]);return(0,o.useMemo)((()=>t?.filter((e=>{let{visibility:t}=e;return!!t?.publicly_queryable}))),[t])};function h(t,r,n){const o=(0,a.useSelect)((t=>t(e.store).getActiveBlockVariation(n,r)?.name),[r]),l=`${n}/${o}`;return(0,a.useSelect)((e=>{if(!o)return!1;const{getBlockRootClientId:r,getPatternsByBlockTypes:n}=e(c.store),a=r(t);return n(l,a).length>0}),[t,o,l])?l:n}const _=(e,t)=>(0,a.useSelect)((r=>{const{getBlockRootClientId:n,getPatternsByBlockTypes:a}=r(c.store),o=n(e);return a(t,o)}),[t,e]),g={order:"asc",_fields:"id,name",context:"view"},f=(e,t)=>{const r=t?.id||e?.find((e=>e.name===t))?.id;if(r)return r;const n=t.toLocaleLowerCase();return e?.find((e=>e.name.toLocaleLowerCase()===n))?.id};function y(e){let{onChange:t,query:r}=e;const{postType:n,taxQuery:a}=r,o=m(n);return o&&0!==o.length?React.createElement(s.__experimentalVStack,{spacing:4},o.map((e=>{const r=a?.[e.slug]||[];return React.createElement(b,{key:e.slug,taxonomy:e,termIds:r,onChange:r=>t({taxQuery:{...a,[e.slug]:r}})})}))):null}function b(e){let{taxonomy:t,termIds:r,onChange:n}=e;const[c,l]=(0,o.useState)(""),[u,m]=(0,o.useState)([]),[h,_]=(0,o.useState)([]),y=(0,i.useDebounce)(l,250),{searchResults:b,searchHasResolved:v}=(0,a.useSelect)((e=>{const{getEntityRecords:n,hasFinishedResolution:a}=e(p.store),o=["taxonomy",t.slug,{...g,search:c,orderby:"name",exclude:r,per_page:20}];return{searchResults:n(...o),searchHasResolved:a("getEntityRecords",o)}}),[c,r]),w=(0,a.useSelect)((e=>{if(!r?.length)return[];const{getEntityRecords:n}=e(p.store);return n("taxonomy",t.slug,{...g,include:r,per_page:r.length})}),[r]);return(0,o.useEffect)((()=>{if(r?.length||m([]),!w?.length)return;const e=r.reduce(((e,t)=>{const r=w.find((e=>e.id===t));return r&&e.push({id:t,value:r.name}),e}),[]);m(e)}),[r,w]),(0,o.useEffect)((()=>{v&&_(b.map((e=>e.name)))}),[b,v]),React.createElement(s.FormTokenField,{label:t.name,placeholder:t?.labels?.search_items,value:u,onFocus:()=>{y(c)},onInputChange:y,suggestions:h,displayTransform:d.decodeEntities,onChange:e=>{const t=new Set;for(const r of e){const e=f(b,r);e&&t.add(e)}_([]),n(Array.from(t))},__experimentalShowHowTo:!1,__nextHasNoMarginBottom:!0,__experimentalExpandOnFocus:!0,__next40pxDefaultSize:!0})}function v(e){let{onChange:t,query:r}=e;const[n,a]=(0,o.useState)(r.search),c=(0,o.useCallback)((0,i.debounce)((()=>{r.search!==n&&t({search:n})}),250),[n,r.search]);return(0,o.useEffect)((()=>(c(),c.cancel)),[n,c]),React.createElement(s.TextControl,{label:(0,l.__)("Keyword","surecart"),value:n,onChange:a,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0})}const w={order:"asc",_fields:"id,title",context:"view"},R=(e,t)=>{const r=t?.id||e?.find((e=>e?.title?.rendered===t))?.id;if(r)return r;const n=t.toLocaleLowerCase();return e?.find((e=>e?.title?.rendered.toLocaleLowerCase()===n))?.id};function x(e){let{query:{include:t},onChange:r}=e;const[n,c]=(0,o.useState)(""),[u,m]=(0,o.useState)([]),[h,_]=(0,o.useState)([]),g=(0,i.useDebounce)(c,250),{searchResults:f,searchHasResolved:y}=(0,a.useSelect)((e=>{const{getEntityRecords:r,hasFinishedResolution:a}=e(p.store),o=["postType","sc_product",{...w,search:n,orderby:"title",exclude:t,per_page:20}];return{searchResults:r(...o),searchHasResolved:a("getEntityRecords",o)}}),[n,t]),b=(0,a.useSelect)((e=>{if(!t?.length)return[];const{getEntityRecords:r}=e(p.store);return r("postType","sc_product",{...w,include:t,per_page:t.length})}),[t]);return(0,o.useEffect)((()=>{if(t?.length||m([]),!b?.length)return;const e=t.reduce(((e,t)=>{const r=b.find((e=>e.id===t));return r&&e.push({id:t,value:r?.title?.rendered}),e}),[]);m(e)}),[t,b]),(0,o.useEffect)((()=>{y&&_(f.map((e=>e?.title?.rendered)))}),[f,y]),React.createElement(s.FormTokenField,{label:(0,l.__)("Products","surecart"),value:u,onFocus:()=>{g(n)},onInputChange:g,suggestions:h,placeholder:(0,l.__)("Search for a product","surecart"),displayTransform:d.decodeEntities,onChange:e=>{const t=new Set;for(const r of e){const e=R(f,r);e&&t.add(e)}_([]),r({include:Array.from(t)})},__experimentalShowHowTo:!1,__nextHasNoMarginBottom:!0,__experimentalExpandOnFocus:!0,__next40pxDefaultSize:!0})}const k=[{label:(0,l.__)("Latest","surecart"),value:"date:desc"},{label:(0,l.__)("Oldest","surecart"),value:"date:asc"},{label:(0,l.__)("Alphabetical, A-Z","surecart"),value:"title:asc"},{label:(0,l.__)("Alphabetical, Z-A","surecart"),value:"title:desc"},{label:(0,l.__)("Price, low to high","surecart"),value:"price:asc"},{label:(0,l.__)("Price, high to low","surecart"),value:"price:desc"}];function E(e){let{onUpdateQuery:t,setAttributes:r,attributes:{type:n,query:a,query:{perPage:o,offset:u,taxQuery:p,order:d,orderBy:m}}}=e;const h=(0,i.useViewportMatch)("medium","<");return React.createElement(c.InspectorControls,null,React.createElement(s.PanelBody,{title:(0,l.__)("Attributes","surecart")},React.createElement(s.RangeControl,{label:(0,l.__)("Products Per Page","surecart"),value:o,onChange:e=>t({perPage:e}),step:1,min:1,max:40}),React.createElement(s.RangeControl,{label:(0,l.__)("Offset","surecart"),value:u,onChange:e=>t({offset:e}),step:1,min:0,max:100}),React.createElement(s.SelectControl,{__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,label:(0,l.__)("Default Sorting","surecart"),options:k,value:`${m}:${d}`,onChange:e=>{const r=e?.split(":");t({order:r[1],orderBy:r[0]})}})),React.createElement(s.PanelBody,{title:(0,l.__)("Products","surecart")},React.createElement(s.SelectControl,{label:(0,l.__)("Products To Show","surecart"),value:n,options:[{value:"all",label:(0,l.__)("All Products","surecart")},{value:"featured",label:(0,l.__)("Featured Products","surecart")},{value:"custom",label:(0,l.__)("Hand Pick Products","surecart")}],onChange:e=>r({type:e})}),"custom"===n&&React.createElement(x,{onChange:t,query:a})),React.createElement(s.__experimentalToolsPanel,{className:"block-library-query-toolspanel__filters",label:(0,l.__)("Filters","surecart"),resetAll:()=>{t({author:"",parents:[],search:"",taxQuery:null})},dropdownMenuProps:h?{}:{popoverProps:{placement:"left-start",offset:259}}},React.createElement(s.__experimentalToolsPanelItem,{label:(0,l.__)("Taxonomies","surecart"),hasValue:()=>Object.values(p||{}).some((e=>!!e.length)),onDeselect:()=>t({taxQuery:null})},React.createElement(y,{onChange:t,query:a})),React.createElement(s.__experimentalToolsPanelItem,{hasValue:()=>!!a.search,label:(0,l.__)("Keyword","surecart"),onDeselect:()=>t({search:null})},React.createElement(v,{onChange:t,query:a}))))}var C=e=>{let{openPatternSelectionModal:t,name:r,clientId:n}=e;const a=!!_(n,r).length;return React.createElement(React.Fragment,null,a&&React.createElement(s.ToolbarGroup,{className:"wp-block-template-part__block-control-group"},React.createElement(s.ToolbarButton,{onClick:t},(0,l.__)("Replace"))))};function P(e){let{setAttributes:t,attributes:r,attributes:{limit:n,ids:a,query:l,query:{perPage:s,include:i}},name:p,clientId:d,openPatternSelectionModal:m}=e;const h=e=>{t({query:{...l,...e}})};(0,o.useEffect)((()=>{h({perPage:n||s,include:a?.length?a:i}),t({limit:null})}),[n,a]);const _=(0,c.useBlockProps)(),g=(0,c.useInnerBlocksProps)(_,{template:u});return React.createElement(React.Fragment,null,React.createElement(E,{attributes:r,setAttributes:t,onUpdateQuery:h}),React.createElement(c.BlockControls,null,React.createElement(C,{name:p,clientId:d,openPatternSelectionModal:m})),React.createElement("div",g))}const S=[["surecart/product-template",{style:{spacing:{blockGap:"30px"}},layout:{type:"grid",columnCount:4}}],["surecart/product-pagination"],["surecart/product-list-no-products",{},[["core/paragraph",{placeholder:(0,l.__)("Add text or blocks that will display when a query returns no products.","surecart"),align:"center",content:(0,l.__)("No products found.","surecart")}]]]];function B(t){let{attributes:r,clientId:n,name:o,openPatternSelectionModal:u}=t;const{replaceInnerBlocks:i}=(0,a.useDispatch)(c.store),p=(0,c.useBlockProps)(),d=h(n,r,o),{blockType:m,activeBlockVariation:_,hasPatterns:g}=(0,a.useSelect)((t=>{const{getActiveBlockVariation:a,getBlockType:l}=t(e.store),{getBlockRootClientId:s,getPatternsByBlockTypes:u}=t(c.store),i=s(n);return{blockType:l(o),activeBlockVariation:a(o,r),hasPatterns:!!u(d,i).length}}),[o,d,n,r]),f=_?.icon?.src||_?.icon||m?.icon?.src,y=_?.title||m?.title;return React.createElement("div",p,React.createElement(s.Placeholder,{icon:f,label:y,instructions:(0,l.__)("Choose a pattern for the product list or start with a basic layout.")},!!g&&React.createElement(s.Button,{variant:"primary",onClick:u},(0,l.__)("Choose","surecart")),React.createElement(s.Button,{variant:"secondary",onClick:()=>{i(n,(0,e.createBlocksFromInnerBlocksTemplate)(S),!1)}},(0,l.__)("Start basic","surecart"))))}function T(t){let{clientId:r,attributes:n,setIsPatternSelectionModalOpen:u,name:p}=t;const[d,m]=(0,o.useState)(""),{replaceBlock:g,selectBlock:f}=(0,a.useDispatch)(c.store),y=(0,o.useMemo)((()=>({previewPostType:"sc_product"})),["sc_product"]),b=h(r,n,p),v=_(r,b),w=(0,o.useMemo)((()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!t)return e;const r=e.map((e=>[e,getPatternSearchRank(e,t)])).filter((e=>{let[,t]=e;return t>0}));return r.sort(((e,t)=>{let[,r]=e,[,n]=t;return n-r})),r.map((e=>{let[t]=e;return t}))}(v,d)),[v,d]),R=(0,i.useAsyncList)(w);return React.createElement(s.Modal,{overlayClassName:"block-library-query-pattern__selection-modal",title:(0,l.__)("Choose a pattern","surecart"),onRequestClose:()=>u(!1),isFullScreen:!0},React.createElement("div",{className:"block-library-query-pattern__selection-content"},React.createElement("div",{className:"block-library-query-pattern__selection-search"},React.createElement(s.SearchControl,{__nextHasNoMarginBottom:!0,onChange:m,value:d,label:(0,l.__)("Search for patterns","surecart"),placeholder:(0,l.__)("Search","surecart")})),React.createElement(c.BlockContextProvider,{value:y},React.createElement(c.__experimentalBlockPatternsList,{blockPatterns:w,shownPatterns:R,onClickPattern:(t,a)=>{const{newBlocks:o,queryClientIds:c}=((t,r,n)=>{const{namespace:a}=r,o=t.map((t=>(0,e.cloneBlock)(t))),c=[],l=[...o];for(;l.length>0;){const e=l.shift();e.name===n&&(a&&(e.attributes.namespace=a),c.push(e.clientId)),e.innerBlocks?.forEach((e=>{l.push(e)}))}return{newBlocks:o,queryClientIds:c}})(a,n,p);g(r,o),c[0]&&f(c[0])}}))))}function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I.apply(null,arguments)}var q=JSON.parse('{"UU":"surecart/product-list"}');(0,e.registerBlockType)(q.UU,{icon:n,edit:e=>{const{clientId:t,attributes:r,name:n}=e,[l,s]=(0,o.useState)(!1),u=(0,a.useSelect)((e=>!!e(c.store).getBlocks(t).length),[t])?P:B;return React.createElement(React.Fragment,null,React.createElement(u,I({},e,{openPatternSelectionModal:()=>s(!0)})),l&&React.createElement(T,{clientId:t,attributes:r,setIsPatternSelectionModalOpen:s,name:n}))},save:function(){return React.createElement(c.InnerBlocks.Content,null)}})}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.m=t,e=[],n.O=function(t,r,a,o){if(!r){var c=1/0;for(i=0;i<e.length;i++){r=e[i][0],a=e[i][1],o=e[i][2];for(var l=!0,s=0;s<r.length;s++)(!1&o||c>=o)&&Object.keys(n.O).every((function(e){return n.O[e](r[s])}))?r.splice(s--,1):(l=!1,o<c&&(c=o));if(l){e.splice(i--,1);var u=a();void 0!==u&&(t=u)}}return t}o=o||0;for(var i=e.length;i>0&&e[i-1][2]>o;i--)e[i]=e[i-1];e[i]=[r,a,o]},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={1131:0,8307:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,o,c=r[0],l=r[1],s=r[2],u=0;if(c.some((function(t){return 0!==e[t]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(s)var i=s(n)}for(t&&t(r);u<c.length;u++)o=c[u],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(i)},r=self.webpackChunk_surecart_blocks_next=self.webpackChunk_surecart_blocks_next||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var a=n.O(void 0,[8307],(function(){return n(4664)}));a=n.O(a)}();