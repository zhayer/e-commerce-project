import{r as t,c as i,h as n,F as o,a as s}from"./p-e97fde0a.js";import{s as e}from"./p-830ab1a3.js";import{i as r}from"./p-b0d8cd6e.js";import{a as l,c as a}from"./p-6ec14893.js";import{s as u}from"./p-021b5199.js";import"./p-3f6362a4.js";import"./p-03631502.js";import"./p-9dbc54d6.js";import"./p-d3366af3.js";import"./p-401e165e.js";import"./p-ec182234.js";import"./p-95325ec5.js";const c=":host {\n  display: block;\n}\n\nsc-button {\n  color: var(--sc-color-primary-500);\n}\n\nsc-alert {\n  margin-top: var(--sc-spacing-small);\n}\n\n.coupon-form {\n  position: relative;\n  container-type: inline-size;\n}\n.coupon-form .coupon-button {\n  opacity: 0;\n  visibility: hidden;\n  transform: scale(0.9);\n  transition: all var(--sc-transition-fast) ease;\n  color: var(--sc-input-color);\n}\n.coupon-form .coupon-button-mobile {\n  margin-top: var(--sc-input-label-margin);\n  display: none;\n}\n.coupon-form--has-value .coupon-button {\n  opacity: 1;\n  visibility: visible;\n  transform: scale(1);\n}\n\n@container (max-width: 320px) {\n  .coupon-form .coupon-button {\n    display: none;\n  }\n  .coupon-form .coupon-button-mobile {\n    display: block;\n  }\n}\n.form {\n  opacity: 0;\n  visibility: hidden;\n  height: 0;\n  transform: translateY(5px);\n  transition: opacity var(--sc-transition-medium) ease, transform var(--sc-transition-medium) ease;\n  position: relative;\n  gap: var(--sc-spacing-small);\n}\n\n.coupon-form--is-open .form {\n  opacity: 1;\n  visibility: visible;\n  transform: translateY(0);\n  height: auto;\n  margin: var(--sc-spacing-small) 0;\n}\n.coupon-form--is-open .trigger {\n  display: none;\n}\n\n.trigger {\n  cursor: pointer;\n  font-size: var(--sc-font-size-small);\n  line-height: var(--sc-line-height-dense);\n  color: var(--sc-input-label-color);\n  user-select: none;\n}\n.trigger:hover {\n  text-decoration: underline;\n}\n\n.coupon-form--is-rtl .trigger {\n  text-align: right;\n}\n\n.coupon__status {\n  font-size: var(--sc-font-size-small);\n  line-height: var(--sc-line-height-dense);\n  color: var(--sc-color-warning-700);\n  display: inline-flex;\n  gap: var(--sc-spacing-x-small);\n  align-items: flex-start;\n  text-align: left;\n}\n.coupon__status sc-icon {\n  flex: 0 0 1em;\n  margin-top: 0.25em;\n}";const p=c;const d=class{constructor(n){t(this,n);this.scApplyCoupon=i(this,"scApplyCoupon",7);this.label=undefined;this.loading=undefined;this.busy=undefined;this.placeholder=undefined;this.error=undefined;this.forceOpen=undefined;this.discount=undefined;this.currency=undefined;this.discountAmount=undefined;this.showInterval=undefined;this.open=undefined;this.collapsed=undefined;this.value=undefined;this.buttonText=undefined;this.editable=true}handleOpenChange(t){if(t){setTimeout((()=>this.input.triggerFocus()),50)}}handleBlur(){if(!this.value){this.open=false;this.error=""}}getHumanReadableDiscount(){var t,i,n;if(((t=this===null||this===void 0?void 0:this.discount)===null||t===void 0?void 0:t.coupon)&&((i=this===null||this===void 0?void 0:this.discount)===null||i===void 0?void 0:i.coupon.percent_off)){return l((n=this===null||this===void 0?void 0:this.discount)===null||n===void 0?void 0:n.coupon)}return""}applyCoupon(){this.scApplyCoupon.emit(this.value)}handleKeyDown(t){if((t===null||t===void 0?void 0:t.code)==="Enter"){this.applyCoupon()}else if((t===null||t===void 0?void 0:t.code)==="Escape"){this.scApplyCoupon.emit(null);this.open=false;e(wp.i18n.__("Coupon code field closed.","surecart"),"assertive")}}translateHumanDiscountWithDuration(t){var i;if(!this.showInterval)return t;const{duration:n,duration_in_months:o}=(i=this.discount)===null||i===void 0?void 0:i.coupon;switch(n){case"once":return`${t} ${wp.i18n.__("once","surecart")}`;case"repeating":const i=wp.i18n.sprintf(wp.i18n._n("%d month","%d months",o,"surecart"),o);return wp.i18n.sprintf(wp.i18n.__("%s for %s","surecart"),t,i);default:return t}}async triggerFocus(){var t,i,n;await new Promise((t=>requestAnimationFrame(t)));if((i=(t=this===null||this===void 0?void 0:this.discount)===null||t===void 0?void 0:t.promotion)===null||i===void 0?void 0:i.code){(n=this.couponTag.shadowRoot.querySelector("*"))===null||n===void 0?void 0:n.focus()}else if(this.addCouponTrigger){this.addCouponTrigger.focus()}}renderTrialText(){var t,i;if(((i=(t=this.discount)===null||t===void 0?void 0:t.coupon)===null||i===void 0?void 0:i.duration)==="once"){return wp.i18n.__("Applies on first payment","surecart")}return wp.i18n.__("Starting on first payment","surecart")}render(){var t,i,s,l,c,p,d,h,v,m,f;const b=!!((t=u===null||u===void 0?void 0:u.checkout)===null||t===void 0?void 0:t.trial_amount)&&!((i=u===null||u===void 0?void 0:u.checkout)===null||i===void 0?void 0:i.amount_due);if(this.loading){return n("sc-skeleton",{style:{width:"120px",display:"inline-block"}})}if((l=(s=this===null||this===void 0?void 0:this.discount)===null||s===void 0?void 0:s.promotion)===null||l===void 0?void 0:l.code){let t=this.getHumanReadableDiscount();return n("sc-line-item",{exportparts:"description:info, price-description:discount, price:amount"},n("span",{slot:"description"},n("div",{part:"discount-label"},wp.i18n.__("Discount","surecart")),n("sc-tag",{exportparts:"base:coupon-tag",type:"redeemable"===((c=this.discount)===null||c===void 0?void 0:c.redeemable_status)?"success":"warning",class:"coupon-tag",clearable:this.editable,onScClear:()=>{if(!this.editable)return;this.scApplyCoupon.emit(null);this.open=false},onKeyDown:t=>{if(!this.editable)return;if(t.key==="Enter"||t.key==="Escape"){e(wp.i18n.__("Coupon was removed.","surecart"),"assertive");this.scApplyCoupon.emit(null);this.open=false}},ref:t=>this.couponTag=t,role:"button","aria-label":wp.i18n.sprintf(wp.i18n.__("Press enter to remove coupon code %s.","surecart"),((d=(p=this===null||this===void 0?void 0:this.discount)===null||p===void 0?void 0:p.promotion)===null||d===void 0?void 0:d.code)||this.input.value||"")},(v=(h=this===null||this===void 0?void 0:this.discount)===null||h===void 0?void 0:h.promotion)===null||v===void 0?void 0:v.code)),"redeemable"===((m=this.discount)===null||m===void 0?void 0:m.redeemable_status)?n(o,null,t&&n("span",{class:"coupon-human-discount",slot:"price-description"},this.translateHumanDiscountWithDuration(t)),n("span",{slot:b?"price-description":"price"},b?this.renderTrialText():n("sc-format-number",{type:"currency",currency:this===null||this===void 0?void 0:this.currency,value:this===null||this===void 0?void 0:this.discountAmount}))):n("div",{class:"coupon__status",slot:"price-description"},n("sc-icon",{name:"alert-triangle"}),a((f=this.discount)===null||f===void 0?void 0:f.redeemable_status)))}return this.collapsed?n("div",{part:"base",class:{"coupon-form":true,"coupon-form--is-open":this.open||this.forceOpen,"coupon-form--has-value":!!this.value,"coupon-form--is-rtl":r()}},n("div",{part:"label",class:"trigger",onMouseDown:()=>{if(this.open){return}this.open=true},onKeyDown:t=>{if(t.key!=="Enter"&&t.key!==" "){return true}if(this.open){return}this.open=true;e(wp.i18n.__("Coupon code field opened. Press Escape button to close it.","surecart"),"assertive")},tabindex:"0",ref:t=>this.addCouponTrigger=t,role:"button"},n("slot",{name:"label"},this.label)),n("div",{class:"form",part:"form"},n("sc-input",{exportparts:"base:input__base, input, form-control:input__form-control",value:this.value,onScInput:t=>this.value=t.target.value,placeholder:this.placeholder,onScBlur:()=>this.handleBlur(),onKeyDown:t=>this.handleKeyDown(t),ref:t=>this.input=t,"aria-label":wp.i18n.__("Add coupon code.","surecart")},n("sc-button",{exportparts:"base:button__base, label:button_label",slot:"suffix",type:"text",loading:this.busy,size:"medium",class:"coupon-button",onClick:()=>this.applyCoupon()},n("slot",null,this.buttonText))),n("sc-button",{exportparts:"base:button__base, label:button_label",type:"primary",outline:true,loading:this.busy,size:"medium",class:"coupon-button-mobile",onClick:()=>this.applyCoupon()},n("slot",null,this.buttonText)),!!this.error&&n("sc-alert",{exportparts:"base:error__base, icon:error__icon, text:error__text, title:error_title, message:error__message",type:"danger",open:true},n("span",{slot:"title"},this.error))),this.loading&&n("sc-block-ui",{exportparts:"base:block-ui, content:block-ui__content"})):n("div",{class:{"coupon-form":true,"coupon-form--has-value":!!this.value,"coupon-form--is-rtl":r()}},n("sc-input",{label:this.label,exportparts:"base:input__base, input, form-control:input__form-control",value:this.value,onScInput:t=>this.value=t.target.value,placeholder:this.placeholder,onScBlur:()=>this.handleBlur(),onKeyDown:t=>this.handleKeyDown(t),ref:t=>this.input=t},n("sc-button",{exportparts:"base:button__base, label:button_label",slot:"suffix",type:"text",loading:this.busy,size:"medium",class:"coupon-button",onClick:()=>this.applyCoupon()},n("slot",null,this.buttonText))),n("sc-button",{exportparts:"base:button__base, label:button_label",type:"primary",outline:true,loading:this.busy,size:"medium",class:"coupon-button-mobile",onClick:()=>this.applyCoupon()},n("slot",null,this.buttonText)),!!this.error&&n("sc-alert",{exportparts:"base:error__base, icon:error__icon, text:error__text, title:error_title, message:error__message",type:"danger",open:true},n("span",{slot:"title"},this.error)))}get el(){return s(this)}static get watchers(){return{open:["handleOpenChange"]}}};d.style=p;export{d as sc_coupon_form};
//# sourceMappingURL=p-a1bf1901.entry.js.map