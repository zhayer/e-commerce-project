{"version":3,"file":"sc-order-shipping-address.js","sourceRoot":"","sources":["../../../../../src/components/controllers/checkout-form/order-shipping-address/sc-order-shipping-address.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, h, Method, Prop, State } from '@stencil/core';\nimport { state as checkoutState, onChange } from '@store/checkout';\nimport { lockCheckout, unLockCheckout } from '@store/checkout/mutations';\nimport { __ } from '@wordpress/i18n';\nimport { createOrUpdateCheckout } from '../../../../services/session';\n\nimport { Address, Checkout } from '../../../../types';\nimport { fullShippingAddressRequired, shippingAddressRequired } from '@store/checkout/getters';\nimport { formLoading } from '@store/form/getters';\n\n@Component({\n  tag: 'sc-order-shipping-address',\n  styleUrl: 'sc-order-shipping-address.scss',\n  shadow: true,\n})\nexport class ScOrderShippingAddress {\n  private input: HTMLScAddressElement | HTMLScCompactAddressElement;\n\n  /** Label for the field. */\n  @Prop() label: string;\n\n  /** Is this required (defaults to false) */\n  @Prop({ mutable: true, reflect: true }) required: boolean = false;\n\n  /** Show the   address */\n  @Prop({ mutable: true }) full: boolean;\n\n  /** Show the name field. */\n  @Prop({ reflect: true }) showName: boolean;\n\n  /** Show the placeholder fields. */\n  @Prop() namePlaceholder: string = __('Name or Company Name', 'surecart');\n  @Prop() countryPlaceholder: string = __('Country', 'surecart');\n  @Prop() cityPlaceholder: string = __('City', 'surecart');\n  @Prop() line1Placeholder: string = __('Address', 'surecart');\n  @Prop() line2Placeholder: string = __('Address Line 2', 'surecart');\n  @Prop() postalCodePlaceholder: string = __('Postal Code/Zip', 'surecart');\n  @Prop() statePlaceholder: string = __('State/Province/Region', 'surecart');\n\n  /** Default country for address */\n  @Prop() defaultCountry: string;\n\n  /** Whether to require the name in the address */\n  @Prop({ reflect: true }) requireName: boolean = false;\n\n  /** Placeholder values. */\n  @Prop() placeholders: Partial<Address> = {\n    name: __('Name or Company Name', 'surecart'),\n    country: __('Country', 'surecart'),\n    city: __('City', 'surecart'),\n    line_1: __('Address', 'surecart'),\n    line_2: __('Address Line 2', 'surecart'),\n    postal_code: __('Postal Code/Zip', 'surecart'),\n    state: __('State/Province/Region', 'surecart'),\n  };\n\n  /** Address to pass to the component */\n  @State() address: Partial<Address> = {\n    country: null,\n    city: null,\n    line_1: null,\n    line_2: null,\n    postal_code: null,\n    state: null,\n  };\n\n  /** Names for the address */\n  names = {\n    name: 'shipping_name',\n    country: 'shipping_country',\n    city: 'shipping_city',\n    line_1: 'shipping_line_1',\n    line_2: 'shipping_line_2',\n    postal_code: 'shipping_postal_code',\n    state: 'shipping_state',\n  };\n\n  async updateAddressState(address: Partial<Address>) {\n    if (JSON.stringify(address) === JSON.stringify(this.address)) return; // no change, don't update.\n    this.address = address;\n    try {\n      lockCheckout('shipping-address');\n      checkoutState.checkout = (await createOrUpdateCheckout({\n        id: checkoutState.checkout?.id,\n        data: {\n          shipping_address: this.address as Address,\n        },\n      })) as Checkout;\n    } catch (e) {\n      console.error(e);\n    } finally {\n      unLockCheckout('shipping-address');\n    }\n  }\n\n  @Method()\n  async reportValidity() {\n    if (!this.input) return true;\n    return this.input?.reportValidity?.();\n  }\n\n  prefillAddress() {\n    // check if address keys are empty, if so, update them.\n    const addressKeys = Object.keys(this.address).filter(key => key !== 'country');\n    const emptyAddressKeys = addressKeys.filter(key => !this.address[key]);\n    if (emptyAddressKeys.length === addressKeys.length) {\n      this.address = { ...this.address, ...(checkoutState.checkout?.shipping_address as Address) };\n    }\n  }\n\n  componentWillLoad() {\n    if (this.defaultCountry && !this.address?.country) {\n      this.address.country = this.defaultCountry;\n    }\n\n    this.prefillAddress();\n    onChange('checkout', () => this.prefillAddress());\n  }\n\n  render() {\n    // use full if checkout requires it, it's set, or we're showing/requiring name field.\n    if (fullShippingAddressRequired() || this.full || this.requireName || this.showName) {\n      return (\n        <sc-address\n          exportparts=\"label, help-text, form-control, input__base, select__base, columns, search__base, menu__base\"\n          ref={el => (this.input = el as any)}\n          label={this.label || __('Shipping Address', 'surecart')}\n          placeholders={{\n            name: this.namePlaceholder,\n            country: this.countryPlaceholder,\n            city: this.cityPlaceholder,\n            line_1: this.line1Placeholder,\n            line_2: this.line2Placeholder,\n            postal_code: this.postalCodePlaceholder,\n            state: this.statePlaceholder,\n          }}\n          names={this.names}\n          required={this.required || shippingAddressRequired()}\n          loading={formLoading()}\n          address={this.address}\n          show-name={this.showName}\n          require-name={this.requireName}\n          onScChangeAddress={e => this.updateAddressState(e.detail)}\n        ></sc-address>\n      );\n    }\n    return (\n      <sc-compact-address\n        ref={el => (this.input = el as any)}\n        required={this.required || shippingAddressRequired()}\n        loading={formLoading()}\n        address={this.address}\n        placeholders={{\n          name: this.namePlaceholder,\n          country: this.countryPlaceholder,\n          city: this.cityPlaceholder,\n          line_1: this.line1Placeholder,\n          line_2: this.line2Placeholder,\n          postal_code: this.postalCodePlaceholder,\n          state: this.statePlaceholder,\n        }}\n        names={this.names}\n        label={this.label}\n        onScChangeAddress={e => this.updateAddressState(e.detail)}\n      ></sc-compact-address>\n    );\n  }\n}\n"]}