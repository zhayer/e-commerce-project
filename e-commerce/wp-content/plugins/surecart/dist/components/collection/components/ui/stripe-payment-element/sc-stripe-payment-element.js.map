{"version":3,"file":"sc-stripe-payment-element.js","sourceRoot":"","sources":["../../../../src/components/ui/stripe-payment-element/sc-stripe-payment-element.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, Event, EventEmitter, h, Method, State, Watch } from '@stencil/core';\nimport { loadStripe } from '@stripe/stripe-js/pure';\nimport { __ } from '@wordpress/i18n';\nimport { addQueryArgs } from '@wordpress/url';\nimport { state as selectedProcessor } from '@store/selected-processor';\n\nimport { CustomStripeElementChangeEvent, FormStateSetter, PaymentInfoAddedParams, ShippingAddress } from '../../../types';\nimport { state as checkoutState, onChange } from '@store/checkout';\nimport { onChange as onChangeFormState } from '@store/form';\nimport { state as processorsState } from '@store/processors';\nimport { currentFormState } from '@store/form/getters';\nimport { createErrorNotice } from '@store/notices/mutations';\nimport { updateFormState } from '@store/form/mutations';\nimport { getCompleteAddress } from '@store/checkout/getters';\nimport { getProcessorByType } from '@store/processors/getters';\n\n@Component({\n  tag: 'sc-stripe-payment-element',\n  styleUrl: 'sc-stripe-payment-element.scss',\n  shadow: false,\n})\nexport class ScStripePaymentElement {\n  /** This element */\n  @Element() el: HTMLScStripePaymentElementElement;\n\n  /** Holds the element container. */\n  private container: HTMLDivElement;\n\n  /** holds the stripe element. */\n  private element: any;\n\n  private unlistenToFormState: () => void;\n  private unlistenToCheckout: () => void;\n\n  /** The error. */\n  @State() error: string;\n\n  /** Are we confirming the order? */\n  @State() confirming: boolean = false;\n\n  /** Are we loaded? */\n  @State() loaded: boolean = false;\n\n  /** The order/invoice was paid for. */\n  @Event() scPaid: EventEmitter<void>;\n\n  /** Set the state */\n  @Event() scSetState: EventEmitter<FormStateSetter>;\n\n  /** Payment information was added */\n  @Event() scPaymentInfoAdded: EventEmitter<PaymentInfoAddedParams>;\n\n  @State() styles: CSSStyleDeclaration;\n\n  async componentWillLoad() {\n    this.fetchStyles();\n    this.syncCheckoutMode();\n  }\n\n  @Watch('styles')\n  async handleStylesChange() {\n    this.createOrUpdateElements();\n  }\n\n  async fetchStyles() {\n    this.styles = (await this.getComputedStyles()) as CSSStyleDeclaration;\n  }\n\n  /**\n   * We wait for our property value to resolve (styles have been loaded)\n   * This prevents the element appearance api being set before the styles are loaded.\n   */\n  getComputedStyles() {\n    return new Promise(resolve => {\n      let checkInterval = setInterval(() => {\n        const styles = window.getComputedStyle(document.body);\n        const color = styles.getPropertyValue('--sc-color-primary-500');\n        if (color) {\n          clearInterval(checkInterval);\n          resolve(styles);\n        }\n      }, 100);\n    });\n  }\n\n  /** Sync the checkout mode */\n  async syncCheckoutMode() {\n    onChange('checkout', () => {\n      this.initializeStripe();\n    });\n  }\n\n  async componentDidLoad() {\n    this.initializeStripe();\n  }\n\n  async initializeStripe() {\n    if (typeof checkoutState?.checkout?.live_mode === 'undefined' || processorsState?.instances?.stripe) {\n      return;\n    }\n\n    const { processor_data } = getProcessorByType('stripe') || {};\n\n    try {\n      processorsState.instances.stripe = await loadStripe(processor_data?.publishable_key, { stripeAccount: processor_data?.account_id });\n      this.error = '';\n    } catch (e) {\n      this.error = e?.message || __('Stripe could not be loaded', 'surecart');\n      // don't continue.\n      return;\n    }\n\n    // create or update elements.\n    this.createOrUpdateElements();\n    this.handleUpdateElement();\n    this.unlistenToCheckout = onChange('checkout', () => {\n      this.fetchStyles();\n      this.createOrUpdateElements();\n      this.handleUpdateElement();\n    });\n\n    // we need to listen to the form state and pay when the form state enters the paying state.\n    this.unlistenToFormState = onChangeFormState('formState', () => {\n      if (!checkoutState?.checkout?.payment_method_required) return;\n      if ('paying' === currentFormState()) {\n        this.maybeConfirmOrder();\n      }\n    });\n  }\n\n  disconnectedCallback() {\n    this.unlistenToFormState();\n    this.unlistenToCheckout();\n  }\n\n  getElementsConfig() {\n    const styles = getComputedStyle(this.el);\n    return {\n      mode: checkoutState.checkout?.remaining_amount_due > 0 ? 'payment' : 'setup',\n      amount: checkoutState.checkout?.remaining_amount_due,\n      currency: checkoutState.checkout?.currency,\n      setupFutureUsage: checkoutState.checkout?.reusable_payment_method_required ? 'off_session' : null,\n      appearance: {\n        variables: {\n          colorPrimary: styles.getPropertyValue('--sc-color-primary-500') || 'black',\n          colorText: styles.getPropertyValue('--sc-input-label-color') || 'black',\n          borderRadius: styles.getPropertyValue('--sc-input-border-radius-medium') || '4px',\n          colorBackground: styles.getPropertyValue('--sc-input-background-color') || 'white',\n          fontSizeBase: styles.getPropertyValue('--sc-input-font-size-medium') || '16px',\n          colorLogo: styles.getPropertyValue('--sc-stripe-color-logo') || 'light',\n          colorLogoTab: styles.getPropertyValue('--sc-stripe-color-logo-tab') || 'light',\n          colorLogoTabSelected: styles.getPropertyValue('--sc-stripe-color-logo-tab-selected') || 'light',\n          colorTextPlaceholder: styles.getPropertyValue('--sc-input-placeholder-color') || 'black',\n        },\n        rules: {\n          '.Input': {\n            border: styles.getPropertyValue('--sc-input-border'),\n          },\n        },\n      },\n    };\n  }\n\n  /** Update the payment element mode, amount and currency when it changes. */\n  createOrUpdateElements() {\n    // need an order amount, etc.\n    if (!checkoutState?.checkout?.payment_method_required) return;\n    if (!processorsState.instances.stripe) return;\n    if (checkoutState.checkout?.status && ['paid', 'processing'].includes(checkoutState.checkout?.status)) return;\n\n    // create the elements if they have not yet been created.\n    if (!processorsState.instances.stripeElements) {\n      // we have what we need, load elements.\n      processorsState.instances.stripeElements = processorsState.instances.stripe.elements(this.getElementsConfig() as any);\n      const { line1, line2, city, state, country, postal_code } = getCompleteAddress('shipping') ?? {};\n\n      // create the payment element.\n      (processorsState.instances.stripeElements as any)\n        .create('payment', {\n          defaultValues: {\n            billingDetails: {\n              name: checkoutState.checkout?.name,\n              email: checkoutState.checkout?.email,\n              ...(line1 && { address: { line1, line2, city, state, country, postal_code } }),\n            },\n          },\n          fields: {\n            billingDetails: {\n              email: 'never',\n            },\n          },\n        })\n        .mount(this.container);\n\n      this.element = processorsState.instances.stripeElements.getElement('payment');\n      this.element.on('ready', () => (this.loaded = true));\n      this.element.on('change', (event: CustomStripeElementChangeEvent) => {\n        const requiredShippingPaymentTypes = ['cashapp', 'klarna', 'clearpay'];\n        checkoutState.paymentMethodRequiresShipping = requiredShippingPaymentTypes.includes(event?.value?.type);\n\n        if (event.complete) {\n          this.scPaymentInfoAdded.emit({\n            checkout_id: checkoutState.checkout?.id,\n            currency: checkoutState.checkout?.currency,\n            processor_type: 'stripe',\n            total_amount: checkoutState.checkout?.total_amount,\n            line_items: checkoutState.checkout?.line_items,\n            payment_method: {\n              billing_details: {\n                email: checkoutState.checkout?.email,\n                name: checkoutState.checkout?.name,\n              },\n            },\n          });\n        }\n      });\n      return;\n    }\n    processorsState.instances.stripeElements.update(this.getElementsConfig());\n  }\n\n  /** Update the default attributes of the element when they cahnge. */\n  handleUpdateElement() {\n    if (!this.element) return;\n    if (checkoutState.checkout?.status !== 'draft') return;\n\n    const { name, email } = checkoutState.checkout;\n    const { line_1: line1, line_2: line2, city, state, country, postal_code } = (checkoutState.checkout?.shipping_address as ShippingAddress) || {};\n\n    this.element.update({\n      defaultValues: {\n        billingDetails: {\n          name,\n          email,\n          address: {\n            line1,\n            line2,\n            city,\n            state,\n            country,\n            postal_code,\n          },\n        },\n      },\n      fields: {\n        billingDetails: {\n          email: 'never',\n        },\n      },\n    });\n  }\n\n  async submit() {\n    // this processor is not selected.\n    if (selectedProcessor?.id !== 'stripe') return;\n    // submit the elements.\n    const { error } = await (processorsState.instances.stripeElements as any).submit();\n    if (error) {\n      console.error({ error });\n      updateFormState('REJECT');\n      createErrorNotice(error);\n      this.error = error.message;\n      return;\n    }\n  }\n\n  /**\n   * Watch order status and maybe confirm the order.\n   */\n  async maybeConfirmOrder() {\n    // this processor is not selected.\n    if (selectedProcessor?.id !== 'stripe') return;\n    // must be a stripe session\n    if (checkoutState.checkout?.payment_intent?.processor_type !== 'stripe') return;\n    // need an external_type\n    if (!checkoutState.checkout?.payment_intent?.processor_data?.stripe?.type) return;\n    // we need a client secret.\n    if (!checkoutState.checkout?.payment_intent?.processor_data?.stripe?.client_secret) return;\n    // confirm the intent.\n    return await this.confirm(checkoutState.checkout?.payment_intent?.processor_data?.stripe?.type);\n  }\n\n  @Method()\n  async confirm(type, args = {}) {\n    const confirmArgs = {\n      elements: processorsState.instances.stripeElements,\n      clientSecret: checkoutState.checkout?.payment_intent?.processor_data?.stripe?.client_secret,\n      confirmParams: {\n        return_url: addQueryArgs(window.location.href, {\n          ...(checkoutState.checkout.id ? { checkout_id: checkoutState.checkout.id } : {}),\n        }),\n        payment_method_data: {\n          billing_details: {\n            email: checkoutState.checkout.email,\n          },\n        },\n      },\n      redirect: 'if_required',\n      ...args,\n    };\n\n    // prevent possible double-charges\n    if (this.confirming) return;\n\n    // stripe must be loaded.\n    if (!processorsState.instances.stripe) return;\n\n    try {\n      this.scSetState.emit('PAYING');\n      const response =\n        type === 'setup' ? await processorsState.instances.stripe.confirmSetup(confirmArgs as any) : await processorsState.instances.stripe.confirmPayment(confirmArgs as any);\n      if (response?.error) {\n        this.error = response.error.message;\n        throw response.error;\n      } else {\n        this.scSetState.emit('PAID');\n        // paid\n        this.scPaid.emit();\n      }\n    } catch (e) {\n      console.error(e);\n      updateFormState('REJECT');\n      createErrorNotice(e);\n      if (e.message) {\n        this.error = e.message;\n      }\n    } finally {\n      this.confirming = false;\n    }\n  }\n\n  render() {\n    return (\n      <div class=\"sc-stripe-payment-element\" data-testid=\"stripe-payment-element\">\n        {!!this.error && (\n          <sc-text\n            style={{\n              'color': 'var(--sc-color-danger-500)',\n              '--font-size': 'var(--sc-font-size-small)',\n              'marginBottom': '0.5em',\n            }}\n          >\n            {this.error}\n          </sc-text>\n        )}\n\n        <div class=\"loader\" hidden={this.loaded}>\n          <div class=\"loader__row\">\n            <div style={{ width: '50%' }}>\n              <sc-skeleton style={{ width: '50%', marginBottom: '0.5em' }}></sc-skeleton>\n              <sc-skeleton></sc-skeleton>\n            </div>\n            <div style={{ flex: '1' }}>\n              <sc-skeleton style={{ width: '50%', marginBottom: '0.5em' }}></sc-skeleton>\n              <sc-skeleton></sc-skeleton>\n            </div>\n            <div style={{ flex: '1' }}>\n              <sc-skeleton style={{ width: '50%', marginBottom: '0.5em' }}></sc-skeleton>\n              <sc-skeleton></sc-skeleton>\n            </div>\n          </div>\n          <div class=\"loader__details\">\n            <sc-skeleton style={{ height: '1rem' }}></sc-skeleton>\n            <sc-skeleton style={{ height: '1rem', width: '30%' }}></sc-skeleton>\n          </div>\n        </div>\n\n        <div hidden={!this.loaded} class=\"sc-payment-element-container\" ref={el => (this.container = el as HTMLDivElement)}></div>\n      </div>\n    );\n  }\n}\n"]}