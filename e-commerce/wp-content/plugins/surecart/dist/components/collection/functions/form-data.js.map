{"version":3,"file":"form-data.js","sourceRoot":"","sources":["../../src/functions/form-data.ts"],"names":[],"mappings":"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","sourcesContent":["interface FormDataEvent extends Event {\n  readonly formData: FormData;\n}\ninterface FormDataEventInit extends EventInit {\n  formData: FormData;\n}\ndeclare var FormDataEvent: {\n  prototype: FormDataEvent;\n  new (type: string, eventInitDict?: FormDataEventInit): FormDataEvent;\n};\n\nexport interface FormSubmitControllerOptions {\n  /** A function that returns the form containing the form control. */\n  form: (input: unknown) => HTMLFormElement | null;\n  /** A function that returns the form control's name, which will be submitted with the form data. */\n  name: (input: unknown) => string;\n  /** A function that returns the form control's current value. */\n  value: (input: unknown) => unknown | unknown[];\n  /** A function that returns the form control's current disabled state. If disabled, the value won't be submitted. */\n  disabled: (input: unknown) => boolean;\n}\n\nexport class FormSubmitController {\n  form: HTMLFormElement | null = null;\n  input: any;\n  options: FormSubmitControllerOptions;\n  constructor(input: any, options?: Partial<FormSubmitControllerOptions>) {\n    this.input = input;\n    this.options = {\n      form: (input: HTMLInputElement) => this.closestElement('sc-form', input)?.shadowRoot?.querySelector('form') || this.closestElement('form', input),\n      name: (input: HTMLInputElement) => input.name,\n      value: (input: HTMLInputElement) => input.value,\n      disabled: (input: HTMLInputElement) => input.disabled,\n      ...options,\n    };\n\n    this.form = this.options.form(this.input);\n    this.handleFormData = this.handleFormData.bind(this);\n  }\n\n  closestElement(selector, el) {\n    if (!el) return null;\n    return (el && el != document && el != window && el.closest(selector)) || this.closestElement(selector, el.getRootNode().host);\n  }\n\n  addFormData() {\n    if (!this.form) return;\n    this.form.addEventListener('formdata', this.handleFormData);\n  }\n\n  removeFormData() {\n    if (!this.form) return;\n    this.form.removeEventListener('formdata', this.handleFormData);\n  }\n\n  handleFormData(event: FormDataEvent) {\n    const name = this.options.name(this.input);\n    const value = this.options.value(this.input);\n\n    if (typeof name === 'string' && typeof value !== 'undefined') {\n      if (Array.isArray(value)) {\n        (value as unknown[]).forEach(val => {\n          if (val) {\n            event.formData.append(name, (val as string | number | boolean).toString());\n          }\n        });\n      } else {\n        if (value) {\n          event.formData.append(name, (value as string | number | boolean).toString());\n        }\n      }\n    }\n  }\n}\n\nexport const parseFormData = (data: any) => {\n  const {\n    email,\n    name,\n    first_name,\n    last_name,\n    phone,\n    password,\n    shipping_city,\n    shipping_country,\n    shipping_line_1,\n    shipping_line_2,\n    shipping_postal_code,\n    shipping_state,\n    billing_city,\n    billing_country,\n    billing_line_1,\n    billing_line_2,\n    billing_postal_code,\n    billing_state,\n    'tax_identifier.number_type': tax_number_type,\n    'tax_identifier.number': tax_number,\n    ...rest\n  } = data;\n\n  const shipping_address = {\n    ...(shipping_city ? { city: shipping_city } : {}),\n    ...(shipping_country ? { country: shipping_country } : {}),\n    ...(shipping_line_1 ? { line_1: shipping_line_1 } : {}),\n    ...(shipping_line_2 ? { line_2: shipping_line_2 } : {}),\n    ...(shipping_postal_code ? { postal_code: shipping_postal_code } : {}),\n    ...(shipping_state ? { state: shipping_state } : {}),\n  };\n\n  const billing_address = {\n    ...(billing_city ? { city: billing_city } : {}),\n    ...(billing_country ? { country: billing_country } : {}),\n    ...(billing_line_1 ? { line_1: billing_line_1 } : {}),\n    ...(billing_line_2 ? { line_2: billing_line_2 } : {}),\n    ...(billing_postal_code ? { postal_code: billing_postal_code } : {}),\n    ...(billing_state ? { state: billing_state } : {}),\n  };\n\n  return {\n    ...(name ? { name } : {}),\n    ...(email ? { email } : {}),\n    ...(first_name ? { first_name } : {}),\n    ...(last_name ? { last_name } : {}),\n    ...(phone ? { phone } : {}),\n    ...(password ? { password } : {}),\n    ...(Object.keys(shipping_address || {}).length ? { shipping_address } : {}),\n    ...(Object.keys(billing_address || {}).length ? { billing_address } : {}),\n    ...(tax_number_type && tax_number ? { tax_identifier: { number: tax_number, number_type: tax_number_type } } : {}),\n    ...(Object.keys(rest)?.length ? { metadata: rest } : {}),\n  };\n};\n\nexport const reportChildrenValidity = async (element: HTMLElement) => {\n  const items = ([...element.shadowRoot.querySelectorAll('*')] as HTMLElement[]).filter((el: any) => typeof el.reportValidity === 'function') as any;\n  for (const el of items) {\n    const isValid = await el.reportValidity();\n    if (!isValid) {\n      return false;\n    }\n  }\n  return true;\n};\n"]}