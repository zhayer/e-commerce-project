{"version":3,"file":"price.js","sourceRoot":"","sources":["../../src/functions/price.ts"],"names":[],"mappings":"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","sourcesContent":["import { __, _n, sprintf } from '@wordpress/i18n';\n\nimport { Coupon } from '../types';\nimport { zeroDecimalCurrencies } from './currency';\n\ntype recurringPriceDetails = { recurring_interval_count?: number; recurring_interval?: 'week' | 'month' | 'year' | 'never'; recurring_period_count: number };\n\nexport const convertAmount = (amount: number, currency: string) => {\n  return zeroDecimalCurrencies.includes(currency) ? amount : amount / 100;\n};\n\nexport const getHumanDiscount = (coupon: Coupon) => {\n  if (coupon?.amount_off && coupon?.currency) {\n    return getFormattedPrice({ amount: coupon.amount_off, currency: coupon.currency });\n  }\n  if (coupon?.percent_off) {\n    // Translators: Percent off.\n    return sprintf(__('%1d%% off', 'surecart'), coupon.percent_off | 0);\n  }\n  return '';\n};\n\nexport const getFormattedDiscount = (coupon: Coupon) => {\n  if (coupon?.percent_off) {\n    return `${coupon.percent_off | 0}%`;\n  }\n  if (coupon?.amount_off && coupon?.currency) {\n    return getFormattedPrice({ amount: coupon.amount_off, currency: coupon.currency });\n  }\n  return '';\n};\n\nexport const getFormattedPrice = ({ amount, currency }: { amount: number; currency: string }) => {\n  const converted = convertAmount(amount, currency);\n\n  return `${new Intl.NumberFormat(undefined, {\n    style: 'currency',\n    currency: currency,\n  }).format(parseFloat(converted.toFixed(2)))}`;\n};\n\n// get the currency symbol for a currency code.\nexport const getCurrencySymbol = (code: string = 'usd') => {\n  const formattedParts = new Intl.NumberFormat(undefined, {\n    style: 'currency',\n    currency: code,\n  }).formatToParts();\n  return formattedParts.find(part => part.type === 'currency')?.value;\n};\n\nexport const translateInterval = (\n  amount: number,\n  interval: string,\n  prefix: string = __('every', 'surecart'),\n  fallback: string = __('once', 'surecart'),\n  showSingle: boolean = false,\n) => {\n  switch (interval) {\n    case 'day':\n      return `${prefix} ${sprintf(showSingle ? _n('%d day', '%d days', amount, 'surecart') : _n('day', '%d days', amount, 'surecart'), amount)}`;\n    case 'week':\n      return `${prefix} ${sprintf(showSingle ? _n('%d week', '%d weeks', amount, 'surecart') : _n('week', '%d weeks', amount, 'surecart'), amount)}`;\n    case 'month':\n      return `${prefix} ${sprintf(showSingle ? _n('%d month', '%d months', amount, 'surecart') : _n('month', '%d months', amount, 'surecart'), amount)}`;\n    case 'year':\n      return `${prefix} ${sprintf(showSingle ? _n('%d year', '%d years', amount, 'surecart') : _n('year', '%d years', amount, 'surecart'), amount)}`;\n    default:\n      return fallback;\n  }\n};\n\nexport const translateAbbreviatedInterval = (amount: number, interval: string, fallback: string = __('once', 'surecart'), showSingle: boolean = false) => {\n  switch (interval) {\n    case 'day':\n      return ` / ${sprintf(showSingle ? _n('%d day', '%d days', amount, 'surecart') : _n('day', '%d days', amount, 'surecart'), amount)}`;\n    case 'week':\n      return ` / ${sprintf(showSingle ? _n('%d wk', '%d wks', amount, 'surecart') : _n('wk', '%d wks', amount, 'surecart'), amount)}`;\n    case 'month':\n      return ` / ${sprintf(showSingle ? _n('%d mo', '%d months', amount, 'surecart') : _n('mo', '%d mos', amount, 'surecart'), amount)}`;\n    case 'year':\n      return ` / ${sprintf(showSingle ? _n('%d yr', '%d yrs', amount, 'surecart') : _n('yr', '%d yrs', amount, 'surecart'), amount)}`;\n    default:\n      return fallback;\n  }\n};\n\ninterface IntervalOptions {\n  showOnce?: boolean;\n  abbreviate?: boolean;\n  labels?: {\n    interval?: string;\n    period?: string;\n    once?: string;\n  };\n}\nexport const intervalString = (price: recurringPriceDetails, options: IntervalOptions = {}) => {\n  if (!price) {\n    return '';\n  }\n  const { showOnce, labels, abbreviate } = options;\n  const { interval = __('every', 'surecart') } = labels || {};\n\n  return `${intervalCountString(price, interval, !!showOnce ? __('once', 'surecart') : '', abbreviate)} ${periodCountString(price, abbreviate)}`;\n};\n\nexport const intervalCountString = (\n  price: { recurring_interval_count?: number; recurring_interval?: 'week' | 'month' | 'year' | 'never'; recurring_period_count: number },\n  prefix,\n  fallback = __('once', 'surecart'),\n  abbreviate = false,\n) => {\n  if (!price.recurring_interval_count || !price.recurring_interval || 1 === price?.recurring_period_count) {\n    return '';\n  }\n  if (abbreviate) {\n    return translateAbbreviatedInterval(price.recurring_interval_count, price.recurring_interval, fallback);\n  }\n  return translateInterval(price.recurring_interval_count, price.recurring_interval, ` ${prefix}`, fallback);\n};\n\nexport const periodCountString = (price: recurringPriceDetails, abbreviate = false) => {\n  if (!price?.recurring_period_count || 1 === price?.recurring_period_count) {\n    return '';\n  }\n  if (abbreviate) {\n    return `x ${price.recurring_period_count}`;\n  }\n\n  return ` (${sprintf(_n('%d payment', '%d payments', price.recurring_period_count, 'surecart'), price.recurring_period_count)})`;\n};\n\nexport const translateRemainingPayments = payments => {\n  return sprintf(_n('%d payment remaining', '%d payments remaining', payments, 'surecart'), payments);\n};\n\nexport const productNameWithPrice = price => {\n  if (!price) {\n    return '';\n  }\n  return `${price?.product?.name} ${price?.name ? `— ${price.name}` : ''}`;\n};\n\nexport const getHumanDiscountRedeemableStatus = status => {\n  switch (status) {\n    case 'invalid':\n      return __('Not valid', 'surecart');\n    case 'expired':\n      return __('Expired', 'surecart');\n    case 'gone':\n      return __('Not available', 'surecart');\n    case 'less_than_min_subtotal_amount':\n      return __('Minimum not met', 'surecart');\n    case 'greater_than_max_subtotal_amount':\n      return __('Order too large', 'surecart');\n    case 'not_applicable':\n      return __('Product(s) not eligible', 'surecart');\n    case 'not_applicable_to_customer':\n      return __('Not eligible', 'surecart');\n    case '':\n      return '';\n    default:\n      return __('Not redeemable', 'surecart');\n  }\n};\n"]}