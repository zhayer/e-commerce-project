{"version":3,"file":"google.js","sourceRoot":"","sources":["../../../src/store/checkout/google.ts"],"names":[],"mappings":"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","sourcesContent":["import { trackEvent } from '../../functions/google';\nimport { maybeConvertAmount } from '../../functions/currency';\nimport { Checkout, LineItem, Product, ShippingMethod } from 'src/types';\n\n/**\n * Handle add to cart event.\n */\nwindow.addEventListener('scAddedToCart', (e: CustomEvent) => {\n  const item: LineItem = e.detail;\n\n  // sanity check.\n  if (!item?.price?.product) return;\n\n  trackEvent('add_to_cart', {\n    currency: item.price?.currency,\n    value: maybeConvertAmount(item?.price?.amount || 0, item.price?.currency || 'USD'),\n    items: [\n      {\n        item_id: (item.price?.product as Product)?.id,\n        item_name: (item.price?.product as Product)?.name,\n        item_variant: (item.variant_options || []).join(' / '),\n        price: maybeConvertAmount(item?.price?.amount || 0, item.price?.currency || 'USD'),\n        currency: item.price?.currency,\n        quantity: item.quantity,\n        discount: item?.discount_amount ? maybeConvertAmount(item?.discount_amount || 0, item.price?.currency || 'USD') : 0,\n      },\n    ],\n  });\n});\n\n/**\n * Handle remove from cart event.\n */\nwindow.addEventListener('scRemovedFromCart', (e: CustomEvent) => {\n  const item: LineItem = e.detail;\n\n  // sanity check.\n  if (!item?.price?.product) return;\n\n  trackEvent('remove_from_cart', {\n    currency: item.price?.currency,\n    value: maybeConvertAmount(item?.price?.amount || 0, item.price?.currency || 'USD'),\n    items: [\n      {\n        item_id: (item.price?.product as Product)?.id,\n        item_name: (item.price?.product as Product)?.name,\n        item_variant: (item.variant_options || []).join(' / '),\n        price: maybeConvertAmount(item?.price?.amount || 0, item.price?.currency || 'USD'),\n        currency: item.price?.currency,\n        quantity: item.quantity,\n        discount: item?.discount_amount ? maybeConvertAmount(item?.discount_amount || 0, item.price?.currency || 'USD') : 0,\n      },\n    ],\n  });\n});\n\n/**\n * Handle view cart event.\n */\nwindow.addEventListener('scViewedCart', (e: CustomEvent) => {\n  const checkout: Checkout = e.detail;\n\n  trackEvent('view_cart', {\n    currency: checkout.currency,\n    value: maybeConvertAmount(checkout.total_amount, checkout.currency),\n    items: (checkout.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      item_name: (item?.price?.product as Product)?.name,\n      currency: item.price?.currency,\n      discount: item.discount_amount ? maybeConvertAmount(item.discount_amount, item.price?.currency) : 0,\n      price: maybeConvertAmount(item?.price?.amount, item.price?.currency),\n      quantity: item.quantity,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n\n/**\n * Handle checkout initiated event.\n */\nwindow.addEventListener('scCheckoutInitiated', (e: CustomEvent) => {\n  const checkout: Checkout = e.detail;\n\n  trackEvent('begin_checkout', {\n    currency: checkout.currency,\n    value: maybeConvertAmount(checkout.total_amount, checkout.currency),\n    items: (checkout.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      item_name: (item?.price?.product as Product)?.name,\n      currency: item.price?.currency,\n      discount: item.discount_amount ? maybeConvertAmount(item.discount_amount, item.price?.currency) : 0,\n      price: maybeConvertAmount(item?.price?.amount, item.price?.currency),\n      quantity: item.quantity,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n\n/**\n * Handle purchase complete event.\n */\nwindow.addEventListener('scCheckoutCompleted', (e: CustomEvent) => {\n  const checkout: Checkout = e.detail;\n\n  trackEvent('purchase', {\n    transaction_id: checkout?.id,\n    value: maybeConvertAmount(checkout?.total_amount, checkout?.currency || 'USD'),\n    currency: (checkout.currency || '').toUpperCase(),\n    items: (checkout?.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      currency: (checkout.currency || '').toUpperCase(),\n      item_name: (item?.price?.product as Product)?.name || '',\n      discount: item?.discount_amount ? maybeConvertAmount(item?.discount_amount || 0, item?.price?.currency || 'USD') : 0,\n      price: maybeConvertAmount(item?.price?.amount || 0, item?.price?.currency || 'USD'),\n      quantity: item?.quantity || 1,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n\n/**\n * Handle payment info added event.\n */\nwindow.addEventListener('scPaymentInfoAdded', (e: CustomEvent) => {\n  const checkout = e.detail;\n\n  trackEvent('add_payment_info', {\n    currency: checkout.currency,\n    value: maybeConvertAmount(checkout.total_amount, checkout.currency),\n    items: (checkout.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      item_name: (item?.price?.product as Product)?.name || '',\n      currency: item.price?.currency,\n      discount: item.discount_amount ? maybeConvertAmount(item.discount_amount, item.price?.currency) : 0,\n      price: maybeConvertAmount(item?.price?.amount, item.price?.currency),\n      quantity: item.quantity,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n\n/**\n * Handle shipping info added event.\n */\nwindow.addEventListener('scShippingInfoAdded', (e: CustomEvent) => {\n  const checkout: Checkout = e.detail;\n  const selectedShippingChoice = checkout?.shipping_choices?.data?.find(method => method.id === checkout?.selected_shipping_choice);\n  const selectedShippingTier = (selectedShippingChoice?.shipping_method as ShippingMethod)?.name || '';\n\n  trackEvent('add_shipping_info', {\n    currency: checkout.currency,\n    value: maybeConvertAmount(checkout.total_amount, checkout.currency),\n    ...(checkout?.discount?.promotion?.code ? { coupon: checkout?.discount?.promotion?.code } : {}),\n    ...(selectedShippingTier ? { shipping_tier: selectedShippingTier } : ''),\n    items: (checkout.line_items?.data || []).map(item => ({\n      item_id: (item?.price?.product as Product)?.id,\n      item_name: (item?.price?.product as Product)?.name || '',\n      currency: item.price?.currency,\n      discount: item.discount_amount ? maybeConvertAmount(item.discount_amount, item.price?.currency) : 0,\n      price: maybeConvertAmount(item?.price?.amount, item.price?.currency),\n      quantity: item.quantity,\n      ...(item?.variant_options?.length ? { item_variant: (item.variant_options || []).join(' / ') } : {}),\n    })),\n  });\n});\n"]}