{"version":3,"file":"utils.js","sourceRoot":"","sources":["../../src/store/utils.ts"],"names":[],"mappings":"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","sourcesContent":["import { Product } from '../types';\n\nconst isObject = item => item && typeof item === 'object' && !Array.isArray(item);\n\nexport const getSerializedState = () => {\n  const storeTag = document.querySelector(`script[type=\"application/json\"]#sc-store-data`);\n  if (!storeTag) return {};\n  try {\n    const state = JSON.parse(storeTag.textContent);\n    if (isObject(state)) return state;\n    throw Error('Parsed state is not an object');\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n  }\n  return {};\n};\n\n/**\n * Is this variant option sold out.\n */\nexport const isProductVariantOptionSoldOut = (optionNumber, option, variantValues, product: Product) => {\n  // product stock is not enabled or out of stock purchases are allowed.\n  if (!product?.stock_enabled || product?.allow_out_of_stock_purchases) return false;\n\n  // if this is option 1, check to see if there are any variants with this option.\n  if (optionNumber === 1) {\n    const items = (product.variants?.data || []).filter?.(variant => variant.option_1 === option);\n    const highestStock = Math.max(...items.map(item => item.available_stock));\n    return highestStock <= 0;\n  }\n\n  // if this is option 2, check to see if there are any variants with this option and option 1\n  if (optionNumber === 2) {\n    const items = (product.variants?.data || []).filter(variant => variant?.option_1 === variantValues.option_1 && variant.option_2 === option);\n    const highestStock = Math.max(...items.map(item => item.available_stock));\n    return highestStock <= 0;\n  }\n\n  // if this is option 4, check to see if there are any variants with all the options.\n  const items = (product.variants?.data || []).filter(\n    variant => variant?.option_1 === variantValues.option_1 && variant?.option_2 === variantValues.option_2 && variant.option_3 === option,\n  );\n  const highestStock = Math.max(...items.map(item => item.available_stock));\n  return highestStock <= 0;\n};\n\n/**\n * Is this variant option missing/unavailable?\n */\nexport const isProductVariantOptionMissing = (optionNumber: number, option: string, variantValues, product: Product) => {\n  // if this is option 1, check to see if there are any variants with this option.\n  if (optionNumber === 1) {\n    return !(product?.variants?.data || []).some(variant => variant.option_1 === option);\n  }\n\n  // if this is option 2, check to see if there are any variants with this option and option 1\n  if (optionNumber === 2) {\n    return !(product?.variants?.data || []).some(variant => variant?.option_1 === variantValues.option_1 && variant.option_2 === option);\n  }\n\n  // if this is option 3, check to see if there are any variants with all the options.\n  return !(product?.variants?.data || []).some(\n    variant => variant?.option_1 === variantValues.option_1 && variant?.option_2 === variantValues.option_2 && variant.option_3 === option,\n  );\n};\n"]}