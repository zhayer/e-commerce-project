{"version":3,"file":"mutations.js","sourceRoot":"","sources":["../../../src/store/product/mutations.ts"],"names":[],"mappings":"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","sourcesContent":["import state from './store';\nimport { toggleCart } from '@store/ui';\nimport { addQueryArgs } from '@wordpress/url';\nimport { setProduct } from './setters';\nimport { addCheckoutLineItem } from '@store/checkout/mutations';\n\nexport const submitCartForm = async (productId: string) => {\n  const productState = state[productId];\n  if (!productState) return;\n  if (!productState.selectedPrice?.id) return;\n  if (productState.selectedPrice?.ad_hoc && (null === productState.adHocAmount || undefined === productState.adHocAmount)) return;\n\n  try {\n    setProduct(productId, { busy: true });\n    await addCheckoutLineItem({\n      price: productState.selectedPrice?.id,\n      quantity: Math.max(productState.selectedPrice?.ad_hoc ? 1 : productState.quantity, 1),\n      ...(productState.selectedPrice?.ad_hoc ? { ad_hoc_amount: productState.adHocAmount } : {}),\n      variant: productState.selectedVariant?.id,\n    });\n    toggleCart(true);\n    setProduct(productId, { dialog: null });\n  } catch (e) {\n    console.error(e);\n    state.error = e;\n    throw e; // Re-throw the caught error\n  } finally {\n    setProduct(productId, { busy: false });\n  }\n};\n\n/**\n * Get the product buy link.\n */\nexport const getProductBuyLink = (productId: string, url: string, query = {}) => {\n  const productState = state[productId];\n\n  if (!productState) return;\n  if (!productState.selectedPrice?.id) return;\n  if (productState.selectedPrice?.ad_hoc && !productState.adHocAmount && 0 !== productState.adHocAmount) return;\n\n  return addQueryArgs(url, {\n    line_items: [\n      {\n        price: productState.selectedPrice?.id,\n        quantity: Math.max(productState.selectedPrice?.ad_hoc ? 1 : productState.quantity, 1),\n        ...(productState.selectedPrice?.ad_hoc ? { ad_hoc_amount: productState.adHocAmount } : {}),\n        ...(productState.selectedVariant?.id ? { variant: productState.selectedVariant?.id } : {}),\n      },\n    ],\n    ...query,\n  });\n};\n"]}