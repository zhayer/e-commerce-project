import{proxyCustomElement,HTMLElement,createEvent,h}from"@stencil/core/internal/client";import{c as getCurrencySymbol}from"./price.js";import{F as FormSubmitController}from"./form-data.js";import{m as maybeConvertAmount,i as isZeroDecimal}from"./currency.js";import{d as defineCustomElement$3}from"./sc-form-control2.js";import{d as defineCustomElement$2}from"./sc-input2.js";import{d as defineCustomElement$1}from"./sc-visually-hidden2.js";const scPriceInputCss=":host{display:block}",ScPriceInputStyle0=scPriceInputCss,ScPriceInput=proxyCustomElement(class extends HTMLElement{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.scChange=createEvent(this,"scChange",7),this.scInput=createEvent(this,"scInput",7),this.scFocus=createEvent(this,"scFocus",7),this.scBlur=createEvent(this,"scBlur",7),this.size="medium",this.name=void 0,this.value="",this.pill=!1,this.label=void 0,this.showLabel=!0,this.help="",this.clearable=!1,this.placeholder=void 0,this.disabled=!1,this.readonly=!1,this.minlength=void 0,this.maxlength=void 0,this.max=void 0,this.min=void 0,this.required=!1,this.invalid=!1,this.autofocus=void 0,this.hasFocus=void 0,this.currencyCode=void 0,this.showCode=void 0}async reportValidity(){const e=this.input.shadowRoot.querySelector("input");return e.setCustomValidity(""),this.min&&this.value&&parseFloat(this.value)<this.min&&(this.invalid=!0,e.setCustomValidity(wp.i18n.sprintf(wp.i18n.__("Must be %d or more.","surecart"),maybeConvertAmount(this.min,this.currencyCode).toString()))),this.max&&this.value&&parseFloat(this.value)>this.max&&(this.invalid=!0,e.setCustomValidity(wp.i18n.sprintf(wp.i18n.__("Must be %d or less.","surecart"),maybeConvertAmount(this.max,this.currencyCode).toString()))),e.reportValidity()}async triggerFocus(e){return this.input.triggerFocus(e)}async setCustomValidity(e){this.input.setCustomValidity(e)}async triggerBlur(){return this.input.blur()}handleFocusChange(){var e,t,s,i;this.hasFocus?null===(t=null===(e=this.input)||void 0===e?void 0:e.focus)||void 0===t||t.call(e):null===(i=null===(s=this.input)||void 0===s?void 0:s.blur)||void 0===i||i.call(s)}handleChange(){this.updateValue(),this.scChange.emit()}handleInput(){this.updateValue(),this.scInput.emit()}updateValue(){const e=parseFloat(this.input.value);if(isNaN(e))return void(this.value="");const t=isZeroDecimal(this.currencyCode)?e:(100*e).toFixed(2);this.value=t.toString(),this.setCustomValidity("")}componentDidLoad(){this.handleFocusChange(),this.formController=new FormSubmitController(this.el).addFormData(),document.addEventListener("wheel",(()=>{this.input.triggerBlur()}))}disconnectedCallback(){var e;null===(e=this.formController)||void 0===e||e.removeFormData()}getFormattedValue(){if(!this.value)return"";const e=parseFloat(this.value);return isNaN(e)?"":maybeConvertAmount(e,this.currencyCode).toString()}render(){return h("sc-input",{key:"6acd20c52b5a3305cf8e3ee0d633fa111e0bea4f",exportparts:"base, input, form-control, label, help-text, prefix, suffix",size:this.size,label:this.label,showLabel:this.showLabel,help:this.help,ref:e=>this.input=e,type:"text",name:this.name,disabled:this.disabled,readonly:this.readonly,required:this.required,placeholder:this.placeholder,minlength:this.minlength,maxlength:this.maxlength,min:this.min?this.min/100:0,step:.01,max:this.max?this.max/100:null,autofocus:this.autofocus,inputmode:"decimal",onScChange:()=>this.handleChange(),onScInput:()=>this.handleInput(),onScBlur:()=>this.scBlur.emit(),onScFocus:()=>this.scFocus.emit(),pattern:"^\\d*(\\.\\d{0,2})?$",value:this.getFormattedValue()},h("span",{key:"ad3e6746f8063b9b1f55da885211e8cb25bf159d",style:{opacity:"0.5"},slot:"prefix"},getCurrencySymbol(this.currencyCode)),h("span",{key:"5a3f492667b004b979346d380541c7ca3cc458e9",slot:"suffix"},h("slot",{key:"e5bfb4decf20e7693716b80e51d2b744249dd731",name:"suffix"},this.showCode&&(null==this?void 0:this.currencyCode)&&h("span",{key:"94de71f635c3f49f0bfe19fc043ddec585132e4d",style:{opacity:"0.5"}},this.currencyCode.toUpperCase()))))}get el(){return this}static get watchers(){return{hasFocus:["handleFocusChange"]}}static get style(){return ScPriceInputStyle0}},[1,"sc-price-input",{size:[513],name:[1],value:[1025],pill:[516],label:[1],showLabel:[4,"show-label"],help:[1],clearable:[4],placeholder:[1],disabled:[516],readonly:[516],minlength:[2],maxlength:[2],max:[514],min:[514],required:[516],invalid:[1540],autofocus:[4],hasFocus:[1540,"has-focus"],currencyCode:[513,"currency-code"],showCode:[4,"show-code"],reportValidity:[64],triggerFocus:[64],setCustomValidity:[64],triggerBlur:[64]},void 0,{hasFocus:["handleFocusChange"]}]);function defineCustomElement(){"undefined"!=typeof customElements&&["sc-price-input","sc-form-control","sc-input","sc-visually-hidden"].forEach((e=>{switch(e){case"sc-price-input":customElements.get(e)||customElements.define(e,ScPriceInput);break;case"sc-form-control":customElements.get(e)||defineCustomElement$3();break;case"sc-input":customElements.get(e)||defineCustomElement$2();break;case"sc-visually-hidden":customElements.get(e)||defineCustomElement$1()}}))}export{ScPriceInput as S,defineCustomElement as d};